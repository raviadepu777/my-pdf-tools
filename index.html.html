<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>1pdfword - Free Online PDF & Word Tools</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
    <script src="https://unpkg.com/pdfjs-dist/build/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = `https://unpkg.com/pdfjs-dist/build/pdf.worker.min.js`;</script>
    <style>
        :root { --main-bg: #0d0f14; --navbar-bg: #1c222d; --sidebar-bg: #12151a; --card-bg: #12151a; --text-primary: #ffffff; --text-secondary: #e0e0e0; --accent-cyan: #42f8f5; --accent-glow: rgba(66, 248, 245, 0.6); --border-color: #2a3447; --success-color: #2ecc71; --error-color: #e74c3c; --font-main: 'Orbitron', sans-serif; }
        * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: var(--font-main); background-color: var(--main-bg); color: var(--text-secondary); line-height: 1.6; overflow-x: hidden; } h1, h2, h3 { color: var(--text-primary); font-weight: 700; } a { color: var(--accent-cyan); text-decoration: none; } .main-header { background-color: var(--navbar-bg); padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid var(--border-color); } .logo { display: flex; align-items: center; } .logo-svg { filter: drop-shadow(0 0 5px var(--accent-glow)); animation: pulse-glow 3s infinite alternate; } @keyframes pulse-glow { from { filter: drop-shadow(0 0 5px var(--accent-glow)); } to { filter: drop-shadow(0 0 15px var(--accent-glow)); } } .logo h1 { font-size: 1.5rem; margin-left: 1rem; } .app-container { display: flex; } .sidebar { width: 280px; background-color: var(--sidebar-bg); padding: 2rem 1rem; height: calc(100vh - 70px); position: sticky; top: 70px; overflow-y: auto; } .sidebar h3 { color: var(--accent-cyan); margin-top: 1.5rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border-color); } .sidebar ul { list-style: none; } .sidebar li a { display: block; padding: 0.75rem 1rem; color: var(--text-secondary); border-radius: 5px; transition: all 0.3s; } .sidebar li a:hover { background-color: rgba(66, 248, 245, 0.1); color: var(--text-primary); text-shadow: 0 0 5px var(--accent-glow); } .main-content { flex-grow: 1; padding: 2rem; } .tools-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; } .tool-card { background-color: var(--card-bg); border: 1px solid var(--border-color); border-radius: 8px; padding: 1.5rem; text-align: center; transition: all 0.3s; display: flex; flex-direction: column; justify-content: space-between; } .tool-card:hover { transform: translateY(-10px) scale(1.03); box-shadow: 0 0 20px var(--accent-glow); border-color: var(--accent-cyan); } .tool-card .icon { font-size: 3rem; margin-bottom: 1rem; color: var(--accent-cyan); text-shadow: 0 0 10px var(--accent-glow); } .tool-card h3 { font-size: 1.2rem; margin-bottom: 0.5rem; } .tool-card p { font-size: 0.9rem; flex-grow: 1; margin-bottom: 1.5rem; } .tool-card .open-tool-btn { background-color: transparent; border: 1px solid var(--accent-cyan); color: var(--accent-cyan); padding: 0.75rem 1rem; border-radius: 5px; cursor: pointer; font-family: var(--font-main); font-weight: 700; transition: all 0.3s; } .tool-card .open-tool-btn:hover { background-color: var(--accent-cyan); color: var(--main-bg); box-shadow: 0 0 15px var(--accent-glow); } .modal { position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.7); display: flex; justify-content: center; align-items: center; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; } .modal.show { opacity: 1; visibility: visible; } .modal-content { background: var(--navbar-bg); padding: 2rem; border-radius: 10px; border: 1px solid var(--accent-cyan); box-shadow: 0 0 30px var(--accent-glow); width: 90%; max-width: 800px; position: relative; max-height: 90vh; overflow-y: auto; } .modal-close { position: absolute; top: 1rem; right: 1.5rem; font-size: 2.5rem; color: var(--text-secondary); background: none; border: none; cursor: pointer; } .file-drop-zone { border: 3px dashed var(--border-color); border-radius: 10px; padding: 3rem; text-align: center; cursor: pointer; } #file-list { margin-top: 1rem; font-size: 0.9rem; max-height: 100px; overflow-y: auto; } .process-btn { display: block; width: 100%; margin-top: 1.5rem; background-color: var(--accent-cyan); color: var(--main-bg); border: none; padding: 1rem; font-size: 1.2rem; font-family: var(--font-main); font-weight: 700; border-radius: 5px; cursor: pointer; } .process-btn:disabled { background-color: var(--border-color); color: var(--text-secondary); cursor: not-allowed; } #toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 3000; } .toast { background-color: var(--navbar-bg); color: var(--text-primary); padding: 1rem 1.5rem; border-radius: 5px; margin-top: 10px; border-left: 5px solid var(--accent-cyan); box-shadow: 0 5px 15px rgba(0,0,0,0.3); opacity: 0; transform: translateX(100%); animation: slideIn 0.5s forwards; } @keyframes slideIn { to { opacity: 1; transform: translateX(0); } } .toast.success { border-left-color: var(--success-color); } .toast.error { border-left-color: var(--error-color); } .tool-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem; } .tool-input { width: 100%; padding: 0.75rem; background-color: var(--main-bg); border: 1px solid var(--border-color); border-radius: 5px; color: var(--text-primary); font-family: var(--font-main); margin-bottom: 1rem; }
    </style>
</head>
<body>
    <header class="main-header">
        <div class="logo">
             <svg class="logo-svg" width="40" height="40" viewBox="0 0 100 100">
                <path d="M25 10 H70 L90 30 V90 H25 Z" stroke="#42f8f5" stroke-width="6" stroke-linejoin="round" fill="rgba(66, 248, 245, 0.1)" />
                <path d="M70 10 V30 H90" stroke="#42f8f5" stroke-width="6" stroke-linejoin="round" fill="none" />
                <path d="M48 65 V35 L62 45" stroke="#ffffff" stroke-width="8" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
            <h1>1pdfword</h1>
        </div>
    </header>
    <div class="app-container">
        <aside class="sidebar">
            <nav>
                <h3>PDF & Document Tools</h3><ul id="document-sidebar-list"></ul>
                <h3>Utility Tools</h3><ul id="utility-sidebar-list"></ul>
            </nav>
        </aside>
        <main class="main-content">
            <div id="tools-grid" class="tools-grid"></div>
        </main>
    </div>
    <div id="tool-modal" class="modal"><div class="modal-content"><button class="modal-close" id="modal-close-btn">&times;</button><h2 id="modal-title">Tool Title</h2><div id="modal-body"></div></div></div>
    <div id="toast-container"></div>
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // This variable will hold the live server URL once detected.
        let RENDER_SERVER_URL = "";

        const tools = [
            { id: 'pdf-to-word', title: 'PDF to Word', icon: 'üìÑ', description: 'Convert PDF files to editable Word documents.', category: 'document', serverTool: true, toFormat: 'docx' },
            { id: 'word-to-pdf', title: 'Word to PDF', icon: 'üìù', description: 'Convert Word documents to professional PDF files.', category: 'document', serverTool: true, toFormat: 'pdf' },
            { id: 'pdf-to-powerpoint', title: 'PDF to PowerPoint', icon: 'üìä', description: 'Transform PDFs into editable PowerPoint slides.', category: 'document', serverTool: true, toFormat: 'pptx' },
            { id: 'merge-pdf', title: 'Merge PDF', icon: 'üîó', description: 'Combine multiple PDF files into one document.', category: 'document' },
            { id: 'split-pdf', title: 'Split PDF', icon: '‚úÇÔ∏è', description: 'Extract pages or split a PDF into multiple documents.', category: 'document' },
            { id: 'pdf-to-jpg', title: 'PDF to JPG', icon: 'üñºÔ∏è', description: 'Convert each page of a PDF into JPG images.', category: 'document' },
            { id: 'jpg-to-pdf', title: 'JPG to PDF', icon: 'üì∑', description: 'Combine multiple JPG images into a single PDF file.', category: 'document' },
            { id: 'image-converter', title: 'Image Converter', icon: 'üîÑ', description: 'Convert images between JPG, PNG, and WEBP.', category: 'utility' },
            { id: 'password-generator', title: 'Password Generator', icon: 'üîë', description: 'Generate strong, secure, and random passwords.', category: 'utility' },
            { id: 'word-counter', title: 'Word Counter', icon: 'üßÆ', description: 'Count words and characters in your text.', category: 'utility' },
        ];
        const DOMElements = {
            sidebarDocList: document.getElementById('document-sidebar-list'),
            sidebarUtilList: document.getElementById('utility-sidebar-list'),
            toolsGrid: document.getElementById('tools-grid'),
            modal: document.getElementById('tool-modal'),
            modalTitle: document.getElementById('modal-title'),
            modalBody: document.getElementById('modal-body'),
            modalCloseBtn: document.getElementById('modal-close-btn'),
            toastContainer: document.getElementById('toast-container'),
        };
        function init() {
            populateUI();
            setupEventListeners();
            // Automatically find the server URL if it's not localhost
            if (window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1') {
                // Find the associated backend service URL provided by Render
                RENDER_SERVER_URL = window.location.origin.replace('-static', '');
            } else {
                 RENDER_SERVER_URL = "http://localhost:3000"
            }
        }
        function populateUI() {
            tools.forEach(tool => {
                const card = document.createElement('article');
                card.className = 'tool-card';
                card.innerHTML = `<div class="icon">${tool.icon}</div><h3>${tool.title}</h3><p>${tool.description}</p><button class="open-tool-btn" data-tool="${tool.id}">Open Tool</button>`;
                DOMElements.toolsGrid.appendChild(card);

                const listItem = document.createElement('li');
                listItem.innerHTML = `<a href="#" data-tool-link="${tool.id}">${tool.icon} ${tool.title}</a>`;
                if(tool.category === 'document') DOMElements.sidebarDocList.appendChild(listItem);
                else DOMElements.sidebarUtilList.appendChild(listItem);
            });
        }
        function setupEventListeners() {
            DOMElements.modalCloseBtn.addEventListener('click', closeModal);
            document.body.addEventListener('click', (e) => {
                const toolTarget = e.target.closest('.open-tool-btn, [data-tool-link]');
                if (toolTarget) {
                    e.preventDefault();
                    openTool(toolTarget.dataset.tool || toolTarget.dataset.toolLink);
                }
            });
        }
        function openTool(toolId) {
            const tool = tools.find(t => t.id === toolId);
            if (!tool) return;
            DOMElements.modalTitle.textContent = tool.title;
            DOMElements.modalBody.innerHTML = ToolUIManager.generate(tool);
            ToolLogicManager.attach(tool);
            DOMElements.modal.classList.add('show');
        }
        function closeModal() { DOMElements.modal.classList.remove('show'); }
        function showToast(message, type = 'info', duration = 4000) {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            DOMElements.toastContainer.appendChild(toast);
            setTimeout(() => toast.remove(), duration);
        }
        const ToolUIManager = {
            generate(tool) {
                const acceptedFiles = {
                    'pdf-to-word': '.pdf', 'word-to-pdf': '.doc, .docx', 'pdf-to-powerpoint': '.pdf',
                    'jpg-to-pdf': 'image/jpeg, image/jpg', 'merge-pdf': '.pdf', 'image-converter': 'image/*',
                    'pdf-to-jpg': '.pdf', 'split-pdf': '.pdf'
                };
                const isMulti = tool.id === 'merge-pdf' || tool.id === 'jpg-to-pdf';
                const fileUploadUI = `<div class="file-drop-zone"><p>Drag & Drop file(s) here</p><input type="file" ${isMulti ? 'multiple' : ''} accept="${acceptedFiles[tool.id] || '.pdf'}" hidden></div><div id="file-list"></div><div id="action-area"><button id="process-btn" class="process-btn" disabled>${tool.serverTool ? 'Upload & Convert' : 'Process'}</button></div>`;

                const toolUIMap = {
                    'split-pdf': fileUploadUI + `<div class="tool-grid"><div><label>Pages (e.g., 1-3, 5):</label><input type="text" id="split-pages" class="tool-input" placeholder="e.g., 1-3, 5"></div></div>`,
                    'word-counter': `<textarea class="tool-input" id="wc-input" placeholder="Paste text..." style="min-height:200px;"></textarea><div id="wc-result" style="text-align:center; margin-top:1rem;">Words: 0 | Characters: 0</div>`,
                    'password-generator': `<div id="pw-display" style="text-align:center; padding:1rem; border:1px solid var(--border-color); cursor:pointer;">Click Generate</div><div class="tool-grid"><div><label>Length: <span id="pw-len-val">16</span></label><input type="range" id="pw-len" min="8" max="64" value="16" class="tool-input"></div></div><button id="pw-gen-btn" class="process-btn">Generate New Password</button>`,
                    'image-converter': `<div class="file-drop-zone"><p>Drop an image file</p><input type="file" accept="image/*" hidden></div><div id="action-area"><div class="tool-grid"><div><label>Format:</label><select id="format-select" class="tool-input"><option value="image/jpeg">JPEG</option><option value="image/png">PNG</option><option value="image/webp">WEBP</option></select></div></div><button id="convert-btn" class="process-btn" disabled>Convert & Download</button></div>`
                };
                return toolUIMap[tool.id] || fileUploadUI;
            }
        };
        const ToolLogicManager = {
            async processServerTool(tool, file) {
                const processBtn = document.getElementById('process-btn');
                processBtn.disabled = true;
                processBtn.textContent = 'Uploading...';
                const formData = new FormData();
                formData.append('file', file);
                formData.append('to', tool.toFormat);
                try {
                    if (!RENDER_SERVER_URL) throw new Error("Server URL not set.");
                    const response = await fetch(`${RENDER_SERVER_URL}/convert`, { method: 'POST', body: formData });
                    if (!response.ok) throw new Error(`Server error: ${response.statusText}`);
                    processBtn.textContent = 'Processing...';
                    showToast('Conversion successful! Download will start.', 'success');
                    const blob = await response.blob();
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = `${file.name.split('.').slice(0, -1).join('.')}.${tool.toFormat}`;
                    link.click();
                    URL.revokeObjectURL(link.href);
                    closeModal();
                } catch (error) {
                    console.error('Conversion Error:', error);
                    showToast('Conversion failed. The server might be busy or starting up. Please try again in 30 seconds.', 'error');
                    processBtn.disabled = false;
                    processBtn.textContent = 'Upload & Convert';
                }
            },
            async processClientFile(tool, files) {
                const processBtn = document.getElementById('process-btn');
                processBtn.disabled = true;
                processBtn.textContent = 'Processing...';
                const { PDFDocument } = PDFLib;
                try {
                    let outputBytes;
                    switch (tool.id) {
                        case 'merge-pdf':
                            const mergedPdf = await PDFDocument.create();
                            for (const pdfFile of files) {
                                const pdfDoc = await PDFDocument.load(await pdfFile.arrayBuffer());
                                const copiedPages = await mergedPdf.copyPages(pdfDoc, pdfDoc.getPageIndices());
                                copiedPages.forEach(page => mergedPdf.addPage(page));
                            }
                            outputBytes = await mergedPdf.save();
                            break;
                        case 'split-pdf':
                            const pages = document.getElementById('split-pages').value;
                            const pageRanges = pages.split(',').flatMap(r => r.includes('-') ? Array.from({ length: r.split('-')[1] - r.split('-')[0] + 1 }, (_, i) => +r.split('-')[0] + i - 1) : +r - 1);
                            const srcDoc = await PDFDocument.load(await files[0].arrayBuffer());
                            const splitPdf = await PDFDocument.create();
                            const copiedPages = await splitPdf.copyPages(srcDoc, pageRanges);
                            copiedPages.forEach(page => splitPdf.addPage(page));
                            outputBytes = await splitPdf.save();
                            break;
                        case 'jpg-to-pdf':
                             const jpgPdf = await PDFDocument.create();
                             for (const file of files) {
                                const imgBytes = await file.arrayBuffer();
                                const image = await jpgPdf.embedJpg(imgBytes);
                                const page = jpgPdf.addPage([image.width, image.height]);
                                page.drawImage(image, { x: 0, y: 0, width: image.width, height: image.height });
                             }
                             outputBytes = await jpgPdf.save();
                             break;
                        case 'pdf-to-jpg':
                            const pdfData = new Uint8Array(await files[0].arrayBuffer());
                            const pdf = await pdfjsLib.getDocument({data: pdfData}).promise;
                            for (let i = 1; i <= pdf.numPages; i++) {
                                const page = await pdf.getPage(i);
                                const viewport = page.getViewport({ scale: 1.5 });
                                const canvas = document.createElement('canvas');
                                canvas.height = viewport.height; canvas.width = viewport.width;
                                await page.render({ canvasContext: canvas.getContext('2d'), viewport }).promise;
                                const link = document.createElement('a');
                                link.href = canvas.toDataURL('image/jpeg');
                                link.download = `page-${i}.jpg`;
                                link.click();
                            }
                            showToast(`Converted ${pdf.numPages} pages to JPG.`, 'success');
                            closeModal();
                            return;
                    }
                    const blob = new Blob([outputBytes], { type: 'application/pdf' });
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(blob);
                    link.download = `${tool.id}-result.pdf`;
                    link.click();
                    URL.revokeObjectURL(link.href);
                    closeModal();
                } catch (e) {
                    showToast(`Error: ${e.message}`, 'error');
                    processBtn.disabled = false;
                    processBtn.textContent = 'Process';
                }
            },
            attach(tool) {
                let files = [];
                const dropZone = DOMElements.modalBody.querySelector('.file-drop-zone');
                if (dropZone) {
                    const fileInput = dropZone.querySelector('input[type="file"]');
                    const fileListDiv = document.getElementById('file-list');
                    const processBtn = document.getElementById('process-btn');
                    const handleFiles = (fileList) => {
                        files = Array.from(fileList);
                        if (files.length > 0) {
                            processBtn.disabled = false;
                            fileListDiv.innerHTML = files.map(f => `<p>${f.name}</p>`).join('');
                        }
                    };
                    dropZone.onclick = () => fileInput.click();
                    fileInput.onchange = (e) => handleFiles(e.target.files);
                    processBtn.onclick = () => {
                        if (tool.serverTool) this.processServerTool(tool, files[0]);
                        else this.processClientFile(tool, files);
                    };
                }
                const utilityLogicMap = {
                    'word-counter': () => {
                        const input = document.getElementById('wc-input');
                        const result = document.getElementById('wc-result');
                        input.oninput = () => {
                            const text = input.value;
                            const words = text.trim() === '' ? 0 : text.trim().split(/\s+/).length;
                            result.innerHTML = `Words: ${words} | Characters: ${text.length}`;
                        };
                    },
                    'password-generator': () => {
                        const display = document.getElementById('pw-display');
                        const gen = () => {
                            const length = document.getElementById('pw-len').value;
                            document.getElementById('pw-len-val').textContent = length;
                            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()';
                            let password = '';
                            for (let i = 0; i < length; i++) password += chars.charAt(Math.floor(Math.random() * chars.length));
                            display.textContent = password;
                        };
                        document.getElementById('pw-gen-btn').onclick = gen;
                        document.getElementById('pw-len').oninput = gen;
                        display.onclick = () => navigator.clipboard.writeText(display.textContent).then(() => showToast('Password copied!', 'success'));
                        gen();
                    },
                    'image-converter': () => {
                        const fileInput = DOMElements.modalBody.querySelector('input[type=file]');
                        const convertBtn = document.getElementById('convert-btn');
                        let file;
                        fileInput.onchange = e => {
                            file = e.target.files[0];
                            if(file) convertBtn.disabled = false;
                        };
                        convertBtn.onclick = () => {
                            if (!file) return;
                            const format = document.getElementById('format-select').value;
                            const reader = new FileReader();
                            reader.onload = e => {
                                const img = new Image();
                                img.onload = () => {
                                    const canvas = document.createElement('canvas');
                                    canvas.width = img.width; canvas.height = img.height;
                                    canvas.getContext('2d').drawImage(img, 0, 0);
                                    canvas.toBlob(b => {
                                        const link = document.createElement('a');
                                        link.href = URL.createObjectURL(b);
                                        link.download = `converted.${format.split('/')[1]}`;
                                        link.click();
                                        URL.revokeObjectURL(link.href);
                                    }, format, 0.9);
                                };
                                img.src = e.target.result;
                            };
                            reader.readAsDataURL(file);
                        }
                    }
                };
                if (utilityLogicMap[tool.id]) utilityLogicMap[tool.id]();
            }
        };
        init();
    });
    </script>
</body>
</html>